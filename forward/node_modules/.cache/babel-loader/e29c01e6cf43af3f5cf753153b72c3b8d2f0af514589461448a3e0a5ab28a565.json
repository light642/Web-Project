{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { relogin } from '@/script/script';\nimport axios from 'axios';\nimport { ref } from 'vue';\nexport default {\n  __name: 'RoomDetails',\n  props: ['room'],\n  emits: ['reserveSuccess'],\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    __expose();\n    const props = __props;\n    const getUrl = () => {\n      return \"http://localhost:8089/images/\" + props.room.id + \".png\";\n    };\n    const roomReservation = ref([]);\n    async function disabledDate(time) {\n      await axios.get(\"/reservation/room/\" + props.room.id).then(res => {\n        for (let i in res.data) roomReservation.value.push(res.data[i]);\n        for (let i in roomReservation.value) {\n          console.log(roomReservation.value[i]);\n        }\n      }).catch(relogin);\n      for (let i in roomReservation.value) {\n        if (time.getTime() >= roomReservation.value[i].startTime && time.getTime() <= roomReservation.value[i].endTime) return true;\n      }\n      return false;\n    }\n    const dateSelected = ref('');\n    const emit = __emit;\n    const reserve = () => {\n      const reservation = {\n        roomId: props.room.id,\n        startTime: dateSelected.value[0],\n        endTime: dateSelected.value[1]\n      };\n      axios.post(\"/reservation\", reservation).catch(relogin).then(() => {\n        emit(\"reserveSuccess\");\n      });\n    };\n    const __returned__ = {\n      props,\n      getUrl,\n      roomReservation,\n      disabledDate,\n      dateSelected,\n      emit,\n      reserve,\n      get relogin() {\n        return relogin;\n      },\n      get axios() {\n        return axios;\n      },\n      ref\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["relogin","axios","ref","props","__props","getUrl","room","id","roomReservation","disabledDate","time","get","then","res","i","data","value","push","console","log","catch","getTime","startTime","endTime","dateSelected","emit","__emit","reserve","reservation","roomId","post"],"sources":["C:/Users/Lenovo/Documents/Workspace/Web Project/forward/src/components/RoomDetails.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <el-image style=\"width: 200px; height: 200px\" :src=\"getUrl()\" />\r\n        <h1>编号：{{ props.room.id }}</h1>\r\n        <h1>类型：{{ props.room.roomType }}</h1>\r\n        <el-date-picker v-model=\"dateSelected\" unlink-panels type=\"daterange\" range-separator=\"到\"\r\n            start-placeholder=\"开始时间\" end-placeholder=\"结束时间\" value-format=\"YYYY-MM-DD\" :disabled-date=\"disabledDate\" />\r\n        <el-button @click.prevent=\"reserve\">预约</el-button>\r\n    </div>\r\n</template>\r\n<script setup>\r\nimport { relogin } from '@/script/script';\r\nimport axios from 'axios';\r\nimport { defineProps, ref } from 'vue';\r\nconst props = defineProps(['room']);\r\nconst getUrl = () => {\r\n    return \"http://localhost:8089/images/\" + props.room.id + \".png\"\r\n}\r\nconst roomReservation = ref([])\r\n\r\nasync function disabledDate(time) {\r\n    await axios.get(\"/reservation/room/\" + props.room.id).then((res) => {\r\n        for (let i in res.data) roomReservation.value.push(res.data[i]);\r\n        for (let i in roomReservation.value) { console.log(roomReservation.value[i]); }\r\n    }).catch(relogin)\r\n    for (let i in roomReservation.value) {\r\n        if (time.getTime() >= roomReservation.value[i].startTime && time.getTime() <= roomReservation.value[i].endTime) return true;\r\n    }\r\n    return false;\r\n}\r\n\r\n\r\nconst dateSelected = ref('')\r\n\r\nconst emit = defineEmits(['reserveSuccess'])\r\nconst reserve = () => {\r\n    const reservation = {\r\n        roomId: props.room.id,\r\n        startTime: dateSelected.value[0],\r\n        endTime: dateSelected.value[1]\r\n    }\r\n    axios.post(\"/reservation\", reservation).catch(relogin).then(() => { emit(\"reserveSuccess\") });\r\n}\r\n</script>"],"mappings":";AAWA,SAASA,OAAO,QAAQ,iBAAiB;AACzC,OAAOC,KAAK,MAAM,OAAO;AACzB,SAAsBC,GAAG,QAAQ,KAAK;;;;;;;;;;IACtC,MAAMC,KAAK,GAAGC,OAAqB;IACnC,MAAMC,MAAM,GAAGA,CAAA,KAAM;MACjB,OAAO,+BAA+B,GAAGF,KAAK,CAACG,IAAI,CAACC,EAAE,GAAG,MAAM;IACnE,CAAC;IACD,MAAMC,eAAe,GAAGN,GAAG,CAAC,EAAE,CAAC;IAE/B,eAAeO,YAAYA,CAACC,IAAI,EAAE;MAC9B,MAAMT,KAAK,CAACU,GAAG,CAAC,oBAAoB,GAAGR,KAAK,CAACG,IAAI,CAACC,EAAE,CAAC,CAACK,IAAI,CAAEC,GAAG,IAAK;QAChE,KAAK,IAAIC,CAAC,IAAID,GAAG,CAACE,IAAI,EAAEP,eAAe,CAACQ,KAAK,CAACC,IAAI,CAACJ,GAAG,CAACE,IAAI,CAACD,CAAC,CAAC,CAAC;QAC/D,KAAK,IAAIA,CAAC,IAAIN,eAAe,CAACQ,KAAK,EAAE;UAAEE,OAAO,CAACC,GAAG,CAACX,eAAe,CAACQ,KAAK,CAACF,CAAC,CAAC,CAAC;QAAE;MAClF,CAAC,CAAC,CAACM,KAAK,CAACpB,OAAO,CAAC;MACjB,KAAK,IAAIc,CAAC,IAAIN,eAAe,CAACQ,KAAK,EAAE;QACjC,IAAIN,IAAI,CAACW,OAAO,CAAC,CAAC,IAAIb,eAAe,CAACQ,KAAK,CAACF,CAAC,CAAC,CAACQ,SAAS,IAAIZ,IAAI,CAACW,OAAO,CAAC,CAAC,IAAIb,eAAe,CAACQ,KAAK,CAACF,CAAC,CAAC,CAACS,OAAO,EAAE,OAAO,IAAI;MAC/H;MACA,OAAO,KAAK;IAChB;IAGA,MAAMC,YAAY,GAAGtB,GAAG,CAAC,EAAE,CAAC;IAE5B,MAAMuB,IAAI,GAAGC,MAA+B;IAC5C,MAAMC,OAAO,GAAGA,CAAA,KAAM;MAClB,MAAMC,WAAW,GAAG;QAChBC,MAAM,EAAE1B,KAAK,CAACG,IAAI,CAACC,EAAE;QACrBe,SAAS,EAAEE,YAAY,CAACR,KAAK,CAAC,CAAC,CAAC;QAChCO,OAAO,EAAEC,YAAY,CAACR,KAAK,CAAC,CAAC;MACjC,CAAC;MACDf,KAAK,CAAC6B,IAAI,CAAC,cAAc,EAAEF,WAAW,CAAC,CAACR,KAAK,CAACpB,OAAO,CAAC,CAACY,IAAI,CAAC,MAAM;QAAEa,IAAI,CAAC,gBAAgB,CAAC;MAAC,CAAC,CAAC;IACjG,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}