{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { relogin } from '@/script/script';\nimport axios from 'axios';\nimport { ref } from 'vue';\nexport default {\n  __name: 'RoomDetails',\n  props: ['room'],\n  emits: ['reserveSuccess'],\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    __expose();\n    const props = __props;\n    const room = ref({\n      id: props.room.id,\n      roomType: props.room.roomType\n    });\n    const id = ref(room.value.id);\n    const getUrl = id => {\n      return \"http://localhost:8089/images/\" + id + \".png\";\n    };\n    const roomReservation = ref([]);\n    axios.get(\"/reservation/room/\" + room.value.id).then(res => {\n      for (let i in res.data) roomReservation.value.push(res.data[i]);\n    }).catch(relogin);\n    const disabledDate = time => {\n      for (let res in roomReservation) {\n        if (time.getTime() >= res.startTime && time.getTime() <= res.endTime) return true;\n      }\n      return false;\n    };\n    const reservation = {\n      roomId: room.value.id\n    };\n    const dateSelected = ref('');\n    const emit = __emit;\n    const reserve = () => {\n      reservation.startTime = dateSelected.value[0];\n      reservation.endTime = dateSelected.value[1];\n      axios.post(\"/reservation\", reservation).catch(relogin);\n      emit(\"reserveSuccess\");\n    };\n    const __returned__ = {\n      props,\n      room,\n      id,\n      getUrl,\n      roomReservation,\n      disabledDate,\n      reservation,\n      dateSelected,\n      emit,\n      reserve,\n      get relogin() {\n        return relogin;\n      },\n      get axios() {\n        return axios;\n      },\n      ref\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["relogin","axios","ref","props","__props","room","id","roomType","value","getUrl","roomReservation","get","then","res","i","data","push","catch","disabledDate","time","getTime","startTime","endTime","reservation","roomId","dateSelected","emit","__emit","reserve","post"],"sources":["C:/Users/Lenovo/Documents/Workspace/Web Project/forward/src/components/RoomDetails.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <el-image style=\"width: 200px; height: 200px\" :src=\"getUrl(id)\" />\r\n        <h1>编号：{{props.room.id}}</h1>\r\n        <h1>类型：{{props.room.roomType}}</h1>\r\n        <el-date-picker v-model=\"dateSelected\" unlink-panels type=\"daterange\" range-separator=\"到\" start-placeholder=\"开始时间\"\r\n                    end-placeholder=\"结束时间\" value-format=\"YYYY-MM-DD\" :disabled-date=\"disabledDate\"/>\r\n        <el-button @click.prevent=\"reserve\">预约</el-button>\r\n    </div>\r\n</template>\r\n<script setup>\r\nimport { relogin } from '@/script/script';\r\nimport axios from 'axios';\r\nimport { defineProps, ref} from 'vue';\r\nconst props = defineProps(['room']);\r\nconst room = ref({\r\n    id: props.room.id,\r\n    roomType:props.room.roomType\r\n})\r\nconst id=ref(room.value.id);\r\nconst getUrl=(id)=>{\r\n    return \"http://localhost:8089/images/\"+id+\".png\"\r\n}\r\nconst roomReservation = ref([])\r\naxios.get(\"/reservation/room/\"+room.value.id).then((res)=>{\r\n    for(let i in res.data) roomReservation.value.push(res.data[i]);\r\n}).catch(relogin)\r\nconst disabledDate = (time)=>{\r\n    for(let res in roomReservation){\r\n        if(time.getTime()>=res.startTime&&time.getTime()<=res.endTime) return true;\r\n    }\r\n    return false;\r\n}\r\nconst reservation ={\r\n    roomId:room.value.id,\r\n}\r\n\r\nconst dateSelected = ref('')\r\n\r\nconst emit=defineEmits(['reserveSuccess'])\r\nconst reserve=()=>{\r\n    reservation.startTime=dateSelected.value[0];\r\n    reservation.endTime=dateSelected.value[1];\r\n    axios.post(\"/reservation\",reservation).catch(relogin);\r\n    emit(\"reserveSuccess\");\r\n}\r\n</script>"],"mappings":";AAWA,SAASA,OAAO,QAAQ,iBAAiB;AACzC,OAAOC,KAAK,MAAM,OAAO;AACzB,SAAsBC,GAAG,QAAO,KAAK;;;;;;;;;;IACrC,MAAMC,KAAK,GAAGC,OAAqB;IACnC,MAAMC,IAAI,GAAGH,GAAG,CAAC;MACbI,EAAE,EAAEH,KAAK,CAACE,IAAI,CAACC,EAAE;MACjBC,QAAQ,EAACJ,KAAK,CAACE,IAAI,CAACE;IACxB,CAAC,CAAC;IACF,MAAMD,EAAE,GAACJ,GAAG,CAACG,IAAI,CAACG,KAAK,CAACF,EAAE,CAAC;IAC3B,MAAMG,MAAM,GAAEH,EAAE,IAAG;MACf,OAAO,+BAA+B,GAACA,EAAE,GAAC,MAAM;IACpD,CAAC;IACD,MAAMI,eAAe,GAAGR,GAAG,CAAC,EAAE,CAAC;IAC/BD,KAAK,CAACU,GAAG,CAAC,oBAAoB,GAACN,IAAI,CAACG,KAAK,CAACF,EAAE,CAAC,CAACM,IAAI,CAAEC,GAAG,IAAG;MACtD,KAAI,IAAIC,CAAC,IAAID,GAAG,CAACE,IAAI,EAAEL,eAAe,CAACF,KAAK,CAACQ,IAAI,CAACH,GAAG,CAACE,IAAI,CAACD,CAAC,CAAC,CAAC;IAClE,CAAC,CAAC,CAACG,KAAK,CAACjB,OAAO,CAAC;IACjB,MAAMkB,YAAY,GAAIC,IAAI,IAAG;MACzB,KAAI,IAAIN,GAAG,IAAIH,eAAe,EAAC;QAC3B,IAAGS,IAAI,CAACC,OAAO,CAAC,CAAC,IAAEP,GAAG,CAACQ,SAAS,IAAEF,IAAI,CAACC,OAAO,CAAC,CAAC,IAAEP,GAAG,CAACS,OAAO,EAAE,OAAO,IAAI;MAC9E;MACA,OAAO,KAAK;IAChB,CAAC;IACD,MAAMC,WAAW,GAAE;MACfC,MAAM,EAACnB,IAAI,CAACG,KAAK,CAACF;IACtB,CAAC;IAED,MAAMmB,YAAY,GAAGvB,GAAG,CAAC,EAAE,CAAC;IAE5B,MAAMwB,IAAI,GAACC,MAA+B;IAC1C,MAAMC,OAAO,GAACA,CAAA,KAAI;MACdL,WAAW,CAACF,SAAS,GAACI,YAAY,CAACjB,KAAK,CAAC,CAAC,CAAC;MAC3Ce,WAAW,CAACD,OAAO,GAACG,YAAY,CAACjB,KAAK,CAAC,CAAC,CAAC;MACzCP,KAAK,CAAC4B,IAAI,CAAC,cAAc,EAACN,WAAW,CAAC,CAACN,KAAK,CAACjB,OAAO,CAAC;MACrD0B,IAAI,CAAC,gBAAgB,CAAC;IAC1B,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}